# 华为云PaaS微服务治理技术 - P150：10.mesher研究-mesher作为提供方-处理流程 - 开源之家 - BV1wm4y1M7m5

好，那么下边呢我们就来学习第二个方面，就是mesure作为提供方啊，是如何被其他微服务所调用的？好，那么下面这个图呢呃大家可以看到这个流程应该和我们刚才讲的作为消费房应该变过来了。大家来看啊。

那这个提供方注意这个提供方是不具备微服务能力的。而现在呢加装了一个measure之后呢，它是不是就具备了微服务能力。所以说其他的这个微服务的是不是就可以通过这个measure来调用这个服务的提供方。



![](img/cad1b63bddea977299b38983bb744173_1.png)

好，它的过程呢是这样的，就是首先这个这个微服务的这个请求。因为这个呃消费者呢是采用这个呃。😊。

![](img/cad1b63bddea977299b38983bb744173_3.png)

CSE框架啊来开发的一个微服务的一个这个程序。所以他去调用啊微服务呢，就请求这个地址叫CSE冒号杠杠。哎，大家应该学过这个scom的话，应该对这个地址不陌生，对吧？好。

那么他去请求这个CSME冒号杠杠哎，这个微服务名称。哎，他首先请求到哪里呢？他就会他就会从这个什么呀？哎服务注册中心里头啊，他去找到measure的地址。所以这个时候他就去请求measure了。

那请求measure之后呢，measure就把这个啊measure就代理的这个这个请求呢，他就最终请求这个呃这个服务的提供方。😊，然后麦秀人就把这个。



![](img/cad1b63bddea977299b38983bb744173_5.png)

得到这个数据呢给这个消费方就这样一个结果。好，所以说大家可以看到这个应该说是这个服务提供方不具备微服务能力。哎，外部想访问啊，要通过meature来访问来访问这个服务提供方。



![](img/cad1b63bddea977299b38983bb744173_7.png)

![](img/cad1b63bddea977299b38983bb744173_8.png)

那么这个呃mesure作为服务提供方，他的这个开发的这个哎步骤。啊，是什么呢？两步也是两步。首先。

![](img/cad1b63bddea977299b38983bb744173_10.png)

啊，因为这个是一个啊微服务框架开发的这个服务呢，他要去调用啊他要去调用meer所代理的这个服务啊啊，他要去写这个地址叫CSE冒号杠杠哎，写这个地址。😊。



![](img/cad1b63bddea977299b38983bb744173_12.png)

这个大家理解吗，因为微服务之间调用是不是都是采用这个呃，因为采用这个微这个这个这个CSE这个微服务引擎开发的嘛。所以他从服务注册中心调微服务，就是这个地址，这没啥质疑的。😊。



![](img/cad1b63bddea977299b38983bb744173_14.png)

关键就是说他调用这个地址呢，它他从这个服务注册中心呢，他是不是就找到了这个measure的地址了。但这个measure你要注意啊，这个measure的地址它不是真正的服务提供方的地址。你懂我意思吧？

measure是不是一个代理呀？所以这个measure哎被调用了之后呢，mesure它要去干嘛？它其实去监清了一个叫做本地服务的地址。😡。



![](img/cad1b63bddea977299b38983bb744173_16.png)

![](img/cad1b63bddea977299b38983bb744173_17.png)

![](img/cad1b63bddea977299b38983bb744173_18.png)

![](img/cad1b63bddea977299b38983bb744173_19.png)

![](img/cad1b63bddea977299b38983bb744173_20.png)

![](img/cad1b63bddea977299b38983bb744173_21.png)

有人有人老师没听懂。就这个消费者去调用matcher。那我问你mecher是不是要把这个调用的请求转发给这个提供方啊？😡。



![](img/cad1b63bddea977299b38983bb744173_23.png)

所以呢他是怎么做到的呢？就需要你配置一个measure所监听的本地服务提供方的这个地址。😡，这个地址注意看到这个是一个环境变量，这个地址。



![](img/cad1b63bddea977299b38983bb744173_25.png)

哎，你就要固定给我配127。0。0。1，为啥？因为matature。😡，他俩是不是在一台计算机matature要调用这个地址，是不是就通过1270。0。1来调用了。但是后边这个端口你要注意了。

就是你这个本地服务的这个端口，假如说是4万。😡。

![](img/cad1b63bddea977299b38983bb744173_27.png)

那么你在你这个环境变量这，你就要配多少辆4万。😡。

![](img/cad1b63bddea977299b38983bb744173_29.png)

懂我意思吧？就是这个端口一定是你所代理的是me所代理的那个本地服务的端口。嗯，最后一步应该是编写接口契约。😡。



![](img/cad1b63bddea977299b38983bb744173_31.png)

![](img/cad1b63bddea977299b38983bb744173_32.png)

为啥？因为因为我们微服务之间的调用都是基于哎open APII的那个契约规范来进行调用的。所以在因为你mer要msure要代理这个要代理这个服务提供方嘛，你将来我问你。😊。

这个注册中心麦er是不是要把要向注册中心里边注册他的这个服务啊，你注册服务不光注册服务吧。😡，你是不是还得注册你的这个接口契约呀？因为你只有注册的接口契约外部是不是才能调用你的接口啊？

所以哎mesure作为提供方，应该总共有三步啊，第一步。😡。

![](img/cad1b63bddea977299b38983bb744173_34.png)

![](img/cad1b63bddea977299b38983bb744173_35.png)

我们说啊这个微服务去调用matature，你就通过这个啊这个CSE的这个地址去调用就可以了啊，指定微服务名称。第二步，me要指定监听本地服务的这个地址这个地址啊，就是你所代理的那个服务的地址啊。

这个IP地址啊固定写成127。0。0。1，然后这个端口呢，就是这个本地服务，它所啊对外提供的这个端口，还有就是这个编写本地服务的接口契约，你只有写了这个接口契约，那外部的服务是不是才能调用你的接口啊？

所以这是三步。😊。

![](img/cad1b63bddea977299b38983bb744173_37.png)

![](img/cad1b63bddea977299b38983bb744173_38.png)

![](img/cad1b63bddea977299b38983bb744173_39.png)

那这三步我们介绍清楚了之后呢，下面我们就按照这个这个图形上边所说的这些内容啊，我们把它实现测试一下。好。



![](img/cad1b63bddea977299b38983bb744173_41.png)

![](img/cad1b63bddea977299b38983bb744173_42.png)