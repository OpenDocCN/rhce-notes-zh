# Redhat红帽 RHCE8.0认证体系课程 - P69：71_Video_Day12_RH294_Ch06_文件目录管理及JINJA2模板 - 好好好二狗 - BV1M3411k77W

第六集。第六章在被管理节点上创建文件和目录。这里的话我们主要涉及的模块有以下这些。但是呢我们已讲过模块是不是有5个？那我这里我就不讲了，不讲这5个模块，或是讲我没讲过三个模块。



![](img/f6cf099bbac19981b12bf9ebf8830f64_1.png)

一个叫做SEFcon，就是上设置安全上下文的啊，安全上下文跟trach类似。其实我们可以集成在user，我们就在f模块里面写，对不对？copy模块里面写，对吧？但我们当那时候写的话，如果是写的SEt。

那就是默认上下文。

![](img/f6cf099bbac19981b12bf9ebf8830f64_3.png)

但是通常它是临时生效，如果设置永久的话，我们是通过这个啊。我这里已经有一个有已经写完了1个SEF contest在这里啊，就我们的index点HTML，我可以设置它的。

有就默认安全上下文这个文件啊为HTPD杠C杠孔杠T，也就是我们的web文件的一个安全上下文，上当然可也可以访问，对不对？



![](img/f6cf099bbac19981b12bf9ebf8830f64_5.png)

运行结果大概这样子啊，如果启用SA6ux的话，我们通常在我们当然我们现在是不需要啊。如果是最小化安装的话，我们是需要安装python3labSinux的。如果是最小化安装。



![](img/f6cf099bbac19981b12bf9ebf8830f64_7.png)

T的话是这个。能没有吗？这个是设置安全上下文了。

![](img/f6cf099bbac19981b12bf9ebf8830f64_9.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_10.png)

然后呢，还有就是brolocking fire。我们之前有学过一个lying fire。lying file呢是可以按行来添加我们的，就修添加修改文件内容。但是broing fire呢它是以。

文本块的形式来处理。对吧文本快与文件快来做流失处理。我们看一下这个剧本。我这个当然我在之前，因为我刚刚刚结束完，就是中职老师国徽班，所以这剧本我还有。



![](img/f6cf099bbac19981b12bf9ebf8830f64_12.png)

Drop in fire。对吧比如说note一，我之前不是有1个HDP里面finish吗？然后我在里面追加东西，记着记住它的格式是要在前面加一个派，然后后面追加啊。



![](img/f6cf099bbac19981b12bf9ebf8830f64_14.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_15.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_16.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_17.png)

后面追加。我们的内容就是用rock参数pass呢就是指明你要修改的文件的一个。

![](img/f6cf099bbac19981b12bf9ebf8830f64_19.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_20.png)

路径用绝对或相对都可以。

![](img/f6cf099bbac19981b12bf9ebf8830f64_22.png)

然后呢，后面brolock加竖线之后呢，是在后面追加的。后面追加之后呢，我们会看到一个。

![](img/f6cf099bbac19981b12bf9ebf8830f64_24.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_25.png)

我这里已经是做做完了一个实验啊，所以的话我们直接看结果。

![](img/f6cf099bbac19981b12bf9ebf8830f64_27.png)

剧本知道怎么写的吧？

![](img/f6cf099bbac19981b12bf9ebf8830f64_29.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_30.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_31.png)

他会在现在啊现在我们。

![](img/f6cf099bbac19981b12bf9ebf8830f64_33.png)

🎼没有追加到没问题。我跑这个剧本answibleplaybook。

![](img/f6cf099bbac19981b12bf9ebf8830f64_35.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_36.png)

杠Vplay box里面的叫做brown in fire。

![](img/f6cf099bbac19981b12bf9ebf8830f64_38.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_39.png)

你看change啊，他已经发生改变，然后他报的报的信息就是brolock insert，对吧？直接插入了。我们看一下这个文件的结果。看到没有？跟我的讲义里面是一样的。它就在这一行之后，整个快插内容。

但是它前面有加一个注释，叫做begin and manage block跟跟and answer manage block。但这两个行是不会显示在我们具体的文件里面的，对吧？它是就是我里面插的多少内容。

你多少行，它是按照块，就是我们四方体啊，就是我们正方形这这组文着立方体立方形对吧？长方体正方体，反正你往下掏多少段，它都会写在里面。这叫这这个模块叫做brocking by。那没有要没要不。

然后接下来有个state模块，state模块呢是根据文件的事实信息，类似搜检索文件的一个事实信息，参数参数提供检索文件属性，确定文件校换和等功能。

它是一个包它是会返回一个包含文件状态值的一个散列的一个字典啊，因此我们单独编量引引引用各项信息。我们看一下state一点样本。



![](img/f6cf099bbac19981b12bf9ebf8830f64_41.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_42.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_43.png)

这个剧本我们在node一上，我要收集这个ETC passWD里面的MD5是吧？

![](img/f6cf099bbac19981b12bf9ebf8830f64_45.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_46.png)

哎，我要收集它的MD5信MDfi的加密信息，加MD5这个值，然后我要输入它的一个校验和。我为了输入校验盒呢，我会将它的输出结果。



![](img/f6cf099bbac19981b12bf9ebf8830f64_48.png)

保存保存到我们的注册变量原造里面。

![](img/f6cf099bbac19981b12bf9ebf8830f64_50.png)

懂我意思吧？然后面说说。

![](img/f6cf099bbac19981b12bf9ebf8830f64_52.png)

在里面伪造点state。里面有一个叫trans up，也就是我们的教验盒。

![](img/f6cf099bbac19981b12bf9ebf8830f64_54.png)

输出结果。

![](img/f6cf099bbac19981b12bf9ebf8830f64_56.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_57.png)

我要看一遍啊。为什么state check sum呢？我们来来通过杠V来就看能看得到看得到了啊，它里面就是veify我们这己定义的一个任务啊，是吧？它它的是整个state参数，这整个结果是这一这一块吧。

我们整个结果是不是说这一块啊？然后他的state里面的。check some对不对？它校练盒，其实所以输出的话是这一个。这一行啊这个结果这里我这样又又不一样了，懂吧？然后像有些返回值的话。

是由anible do记录，然后并并或者我们注册一个变量，并显示其他可用信息。对吧我可以返回所有。对C two点压来讲这个东西。对吧我将这个state，我的文件状态，我保存到一个注册变量。

叫做state下划限，比造。

![](img/f6cf099bbac19981b12bf9ebf8830f64_59.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_60.png)

然后我可以通过debug是吧？debu模块你知道怎么用的吧？它可以显示屏幕上输出指定信息，也可以输出我们的一个指定的变量值。



![](img/f6cf099bbac19981b12bf9ebf8830f64_62.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_63.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_64.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_65.png)

对吧。输出了这么多的我们的文件状态信息是吧？它区块它大小啊，它属性啊，它修改时间啊等等，对吧？明白我意思吗？



![](img/f6cf099bbac19981b12bf9ebf8830f64_67.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_68.png)

好，我们讲就这这个是第一部分。第六章的第一部分管理文件跟目录，我们就补充了这三个三个模块啊，broing five state，还有那个叫做SEF content这三个模块。



![](img/f6cf099bbac19981b12bf9ebf8830f64_70.png)

好吧，那接下来我们来讲。一个这张的一个核心叫金家兔的模板。

![](img/f6cf099bbac19981b12bf9ebf8830f64_72.png)

这个里面综合练习，包括考试都会考的啊，至至少一题。sible引擎呢有许多模块可以修改现有文件，其实包括我们lineing find跟 find等等。但是它不能总是这么用吧，对吧？

管理文件一个更强大的一个办法呢就是构建模板，像我们编程，像我们做一个。文本文件都有模板是吧？只要像我们写东西都有模板再套进去就可以了，对吧？它其其实我们可以构建模板，通过这个方法呢。

可以使用S5变量跟事实来编写一个模板配置文件。在部署该文件的时候，自动为收完主机自定义，对吧？这样我可以容易控制，也不会出错。其实也就是我写一个模板之后呢，我我通过模板升给复制对应的主机上。

我就可以将它里面的变量转化为相应的值。懂我意思吗？模板的作用。金加它是采用金加兔的格式啊，新加兔格式也是基于pyython的。好，我们来重点来看这几个相关的分格符。

一个是中间我们ESPRexpression代表是表达式啊。如果是大括号把分号括起来的，是用于表达式或是逻辑。比如说。循环判断我们待会会讲到一个叫做经销。

就是for跟in就是我们的模板里面要怎么写才是正确的啊。然后还有一就是两个大括号括起来，就是用于下我们的最终或输出的表达式以及变了一个结果。在呈现时候呢，它会自动变为我们的实际的一个值。

然后还有comment就定于注释啊。

![](img/f6cf099bbac19981b12bf9ebf8830f64_74.png)

大挂星号代表注释不会出现在最终的文件里面。

![](img/f6cf099bbac19981b12bf9ebf8830f64_76.png)

然后我们接下来讲完了这个，就大家知道这几个分隔符之后呢，我们要我我们开始要构建模板了。新加兔模板有多个元素组词组成，数据变量以及表达式。在呈现模板时候呢，这些变量和表达式会被替换回对应的值。

模板里面可以在推book里面的变量图里面去指定啊，可以将受管组件实实作为变量。我们来看一下这个。

![](img/f6cf099bbac19981b12bf9ebf8830f64_78.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_79.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_80.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_81.png)

我这已经写好了啊，写好了叫做template deployy。

![](img/f6cf099bbac19981b12bf9ebf8830f64_83.png)

兔点压的话。这个剧本文件我来解释一下是干嘛的。

![](img/f6cf099bbac19981b12bf9ebf8830f64_85.png)

好吧，首先。我这个。

![](img/f6cf099bbac19981b12bf9ebf8830f64_87.png)

我我这个剧本文件呢是一个web的我们的阿帕奇啊，还知道吧？阿帕奇我们是不是有配置文件，是有叫HTDBD点comHTDBD点com呢，我如我一般来说我因为每台机构特定的一个配置，那好，我可以以此来做模板。

我会复制到对应主机上对吧？我这里就讲一个HTTPD模板的一个部署。然后假假设我的那个后在note2在note2附属的HTTPD模板。然后呢我收集试试啊。因为这里的话因为每个模板的话，里面。



![](img/f6cf099bbac19981b12bf9ebf8830f64_89.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_90.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_91.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_92.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_93.png)

我一个有一个情令就是我们的先听的1个IP地址。是不一样的。对吧每台机器我提供服务的H我们外我们的IP地址是不一样的。对吧。可以明白我意思吧。所以的话我们这里。会做模板来对它进行替换啊，对要进行替换替换。

我们来分析一下里面的步骤。我这里我可以顺便我打开一个note two。

![](img/f6cf099bbac19981b12bf9ebf8830f64_95.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_96.png)

我打开node two，我首先来第一个，我要构建我们的模板文件。首先当然你我要在节点上面，我要装好我们的web服务啊，H阿帕奇也就我们HTTBD装好之后呢，我可以通过贵我们的文本处理三节课，对吧？

文本处理三节课可以把这句话知道什么意思吗？我可以通过g把开头式空格带井号的所有行，以及仅把多了开头的所有行去掉。留下来了是不是全部都纸金水？



![](img/f6cf099bbac19981b12bf9ebf8830f64_98.png)

对吧全部都是我们配置项。那我这里我执行一下给大家看一看。然后我ca迪，我我摸一下。

![](img/f6cf099bbac19981b12bf9ebf8830f64_100.png)

TMP里面的 template too。

![](img/f6cf099bbac19981b12bf9ebf8830f64_102.png)

是不是剩下的就这些了哦。

![](img/f6cf099bbac19981b12bf9ebf8830f64_104.png)

懂了吧？空格带空格带信号的，它它就它原本文件是怎么样的呢？

![](img/f6cf099bbac19981b12bf9ebf8830f64_106.png)

给他对比对比一下。

![](img/f6cf099bbac19981b12bf9ebf8830f64_108.png)

我现在已经被替换过了。

![](img/f6cf099bbac19981b12bf9ebf8830f64_110.png)

跳有没替换过，前面是型号空格的对，信号空格这些我们原本的文件呢。

![](img/f6cf099bbac19981b12bf9ebf8830f64_112.png)

嗯，可以，我付我我我我看一下，我我给你看一下ETC完 user需要告诉里面。

![](img/f6cf099bbac19981b12bf9ebf8830f64_114.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_115.png)

有。HDPD。有ex张le的给你看一下。

![](img/f6cf099bbac19981b12bf9ebf8830f64_117.png)

因为这里我是我都已经替换过了SJPD然后呢。

![](img/f6cf099bbac19981b12bf9ebf8830f64_119.png)

Defaer。

![](img/f6cf099bbac19981b12bf9ebf8830f64_121.png)

给看一下默认配存是怎么样子的。

![](img/f6cf099bbac19981b12bf9ebf8830f64_123.png)

我意思去掉就这些。这些是不是全部都是注释啊？

![](img/f6cf099bbac19981b12bf9ebf8830f64_125.png)

那我模板是不是不需要这些东西啊？我自定一个模板，是不我把图师去掉就行了。

![](img/f6cf099bbac19981b12bf9ebf8830f64_127.png)

然后把这这些要留下。

![](img/f6cf099bbac19981b12bf9ebf8830f64_129.png)

对吧关键的配置项我要留下，但是我这些打井号的全部不需要。

![](img/f6cf099bbac19981b12bf9ebf8830f64_131.png)

懂我意思吧？所以做一个简览模板呢，我的最终的呈现效果，现在这个已经改过了啊。我最终呈现效果是不是这样？



![](img/f6cf099bbac19981b12bf9ebf8830f64_133.png)

是不是简化很多。

![](img/f6cf099bbac19981b12bf9ebf8830f64_135.png)

好，这是我的第一步的一个作用。第一步的一个作用就是我们呈现模板。然后接下来我要修改模板，修改模板的作用呢就是把特定的。比如说我就是这里就是把我们的。listson这一行。

因为listson这一行干什么用呢？就是我们的。监听我们的IP地址，对不对？IP地址。那IP地址怎么获取呢？我们在我们学过an事实管理情况下，是不是在an里面的defa下划线IPB字点啊。

里面的 addressdress是不是可以获取到我们的IP地址？对吧。所以这点就这一个部分就是利用我们的均加兔模板来替换的。懂我意思吗？把，用用line块把这一个远端文件模板，把它这一把我们的。



![](img/f6cf099bbac19981b12bf9ebf8830f64_137.png)

这一个字段listson这里把它换掉。

![](img/f6cf099bbac19981b12bf9ebf8830f64_139.png)

懂我意思吧？好，然后呢接下来因接下来我们要用到一个tempate，tempate复制的时候，它才会把我们的模板。



![](img/f6cf099bbac19981b12bf9ebf8830f64_141.png)

🎼复制过去之后，将它的变量转换为它的值转换为实际的值。但是我们考虑到，因为之前的话很多人就直接哎我就这我就直接做这一步，但是有问题。因为你修改的，我们是在node2上面去专门的服务，对吧？



![](img/f6cf099bbac19981b12bf9ebf8830f64_143.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_144.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_145.png)

我们是在node2上面去装这个服务。那这个文件我并不在控制节点上面，我们temperate的作用是在控制主机上面是吧？在控制主机上面，然后我把。



![](img/f6cf099bbac19981b12bf9ebf8830f64_147.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_148.png)

模板修改的话就复制过去。但是我这个文件并不在我控制主机上，那我是不是可以加一个flash模块啊？

![](img/f6cf099bbac19981b12bf9ebf8830f64_150.png)

把这个文件拉过来，到后再我们有一个思路是吧？但有其他思路可以告诉我啊，可以，我们可以把这个文件拉过来再放过去。



![](img/f6cf099bbac19981b12bf9ebf8830f64_152.png)

可以对吧。然后换过去的时候，我们用tempate temperatureempate这个就是复制模板到对应主机上，而且它会把模板里面的新加兔啊这一块的值替换成实际的值。所以这里的话是tempate。

主要指定source跟 destinationination。

![](img/f6cf099bbac19981b12bf9ebf8830f64_154.png)

就可以啊。

![](img/f6cf099bbac19981b12bf9ebf8830f64_156.png)

懂我意思吧？好，运行的结果我们来看一看。

![](img/f6cf099bbac19981b12bf9ebf8830f64_158.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_159.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_160.png)

你看这里的话，先改了模板之后呢。Yes。对吧复制过去之后呢，我来拉回拉回来。早复制到回复制回去。就相当于我把这个模板应用到了实际的配置文件里面。懂我意思吧。然后这里有人会问了。

copy模块跟tempate模块。如果copy模块，我这里我比如说我就写1个TMP hostst。我这里写就是SO fat里面就获取我们的IP地址列表，IP地址，还有我们的完整主机名。能能懂我意思吧？

我们竞价通模板，我这里写的两个，是不是我们通过安O安f里面来调用，对吧？然后我用copy tape的样本给大家看一下。我这里。日ho一2分别用toppy。他的type两个模块，然后给大家做一下对比。

这个文件我是专门写来对比的。

![](img/f6cf099bbac19981b12bf9ebf8830f64_162.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_163.png)

好，我们来看其中一台文件，其中一个这台机器。呃，Sible啊还是用临时命令吧。能听懂吗？对吧？我开两个文件，同时开两个文件。host杠一，还有TNP。喂，还有还有host杠2。第一个。

后s杠一是第行的那容，我复制的话，内容原封不动。懂我意思吧？内容原封不动。第二个。我用tid的是不是被被替换了？所以新加坡模板其实好多地方都在这里。我写我最对应的变量，我我我我要部署模板，对应的变量。

就我们写好对应的一个语句。我们的模板语句之后呢，我复通过tempate模块复制到对应的数完主机上，它的值就会被替换成实际的值。懂我意思吧？我用copy的话，我这里没变过了，原封不动。能明白吧？

对吧那这里的话我就我这我用后后2这样看就知道知道了啊。所以小学呢。注意啊，这里的话它是视为那个变量跟表达式是要至于标记跟分格弧分格符就我们空格啊，空格之间。所以的话我们主要讲这三个。没过的话请扣字我D。

那接下我们讲学环的判断。那今天我进度会稍微快一点，因有最后一天了。明白这块这块明白话，请扣司亩地。好，接下来我们讲执行加授，我们中午就把第二章讲完就行了。下午重点讲角色哈。呃，精雕兔呢它有一个语法啊。

循环的语法是for变量引列表。我们用判断循环的一个表达式就是百分号。高。到上外科吧。然后呢，我来看一下啊。语法是这样的，for变量音列表或是某些表达式都可以啊。然后里面就如果满足条件，就是文本内容。

比如调用变量对吧？调用变量，然后后面结尾是and for。新加图的格式啊，and for结尾懂了吧？它使用一个force来提供功能，然后我们循环里面的列表里面啊，我这里的话我可以通过一个模板。

我这里就这这里我的书本上解释我就不看了。我以一个例子来告诉大家。这里我先去我用新加 to four，我这是循环创建用户啊。就学生这个就一个用户模板，我把它导出来。不是创建用户。

这是一个导出用户模板的一个对吧？我这里定一个用户，就是变量user，然后。这个模板是有一写好的啊。啊，然后在我这个变量user在我们的user变量里面，如果他满足条件的话。

我就批量输出我们user量这样打下来。然后我看一下具体的剧本。惊吓兔。放对典压嘛。均价突破已遭后。

![](img/f6cf099bbac19981b12bf9ebf8830f64_165.png)

这里我是定了一个变量组，里面有user一个user2，对吧？

![](img/f6cf099bbac19981b12bf9ebf8830f64_167.png)

耶束素，让我copytate。

![](img/f6cf099bbac19981b12bf9ebf8830f64_169.png)

我t是不是写在这里了？

![](img/f6cf099bbac19981b12bf9ebf8830f64_171.png)

对吧。源头是这个，然后我负责user C，那我们来看一下执行结果。

![](img/f6cf099bbac19981b12bf9ebf8830f64_173.png)

我们在在所有主义上实现。

![](img/f6cf099bbac19981b12bf9ebf8830f64_175.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_176.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_177.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_178.png)

好，我们来看一下anible。我看一台机械就行了。TMP的，我刚才复制了一个文件叫做users一是吧？看到没有？我的模板我给我呈现的结果是这个。对吧forouruser inuser这个变量。

在user这个列表变量列表组里面，我就会循环输出它这个。

![](img/f6cf099bbac19981b12bf9ebf8830f64_180.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_181.png)

对吧user name，然后输出对应的user值。

![](img/f6cf099bbac19981b12bf9ebf8830f64_183.png)

在我们copy完模板之后呢，他会。变成U手一跟Uer2，对不对？懂我意思吧？然后我也可以有另外一个例子，就是我来输出我的IP地址跟主机名。我们这个。模板叫做hos点追 two。通常我们写新加坡模板的话。

我们会以点J two作为结尾。对吧for hosting group service啊，我这里改一下，我这里改要改一下清单了。把service队我放出来。然后把DEVM加这去掉。



![](img/f6cf099bbac19981b12bf9ebf8830f64_185.png)

把他打上复士。对吧如果主机hosse这个变量是主机，在这个组里面，在serv这个主机组里面，那我就输出内容输出为。他的IPPC地址以及它的完整属机名。我这样解释能听懂吗？

然后我来看一下均加for two点15。剧本怎么写的？我直接copy temperate啊，上一集目录的host点t two。



![](img/f6cf099bbac19981b12bf9ebf8830f64_187.png)

然后复制到TFBhos里面，授权主机是service组，懂我意思吧？好，我们来看一下。

![](img/f6cf099bbac19981b12bf9ebf8830f64_189.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_190.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_191.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_192.png)

这也是模板文件你要存在的。

![](img/f6cf099bbac19981b12bf9ebf8830f64_194.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_195.png)

好，发是OK我们看一下。

![](img/f6cf099bbac19981b12bf9ebf8830f64_197.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_198.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_199.png)

这里无足不U外，它会复制两次啊复制两次，但无所谓啊无所谓。因为两台主机的话，它复制两次无所谓啊，只要但是我们能看到这个更改，它会把我们的模板是不是替换成。替换人值了是吧？好，这个是均加 for一个循环。

均加if呢我if我们讲的判断啊，判断是满足条件里面，但这里满足条件它是会在文本里面添加内容。

![](img/f6cf099bbac19981b12bf9ebf8830f64_201.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_202.png)

就加fo的话也是相当于添加内容啊，输出内容的其实模板就连模板就是把。拿来加内容用的，不是用做什么判断啊，逻辑处理这这样。



![](img/f6cf099bbac19981b12bf9ebf8830f64_204.png)

像金家一服，它是这样衣服条件，然后语，然后后面是语句是吧？文们的添加内容。

![](img/f6cf099bbac19981b12bf9ebf8830f64_206.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_207.png)

添加内容语句。

![](img/f6cf099bbac19981b12bf9ebf8830f64_209.png)

然后后面有and if。

![](img/f6cf099bbac19981b12bf9ebf8830f64_211.png)

作为结束。到这里我有一个。一个例子。我这里再写一个posts to点追 two。这个模板我是会写到一个hose name。短组机名。好吧。当主任明。

如果iphone findPV4 addressdress就他的。

![](img/f6cf099bbac19981b12bf9ebf8830f64_213.png)

地址是203对吧？他会输加往往里面往模板里面把它在既有文件里面加一个内容。

![](img/f6cf099bbac19981b12bf9ebf8830f64_215.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_216.png)

好，我们来看一下。剧本在这里。金价y。同样也是复制模板。我们看一下执行结果。

![](img/f6cf099bbac19981b12bf9ebf8830f64_218.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_219.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_220.png)

![](img/f6cf099bbac19981b12bf9ebf8830f64_221.png)

对啊，都发生改变。来看一下是不是我note2，我就不输出任何东西了。但note一。我最喜欢哦啊。node一是有东西对吧？就是说短组里面那n是空的。懂我意思吗？

因为他判断条件就是我的IP地址是140035来做。懂我意思吧？好，接下来我们第六章已经讲完。如果懂的话，请扣个一啊，字母一。没办法请扣个字母一哈。好，现下来有一个练习。当紧咱们做一下啊。

我要生成一个模板，生成一个模板之后呢。是跟跟ETC host相同的一个格式。然后呢创建一个playbook。后s要么，然后允许再连在我们service组的主机生成1个EDC myho的文件。

然后完成之后呢service主机组主机上文件EDC myho应该为每台售备。每台售管主机。来添加一下内容，这两个是有的啊。然后还有后面就是留空完之后，就是IP地址。

对吧然后注意写清单主机名称的显示次序不重要。就如果哪怕他颠倒的显示也没太大问别。那这道练习请大做一下。第章我经讲完了。可以思考一下怎么做。其实也就是用我们的水。循环吗。

那这个IP地址呢是根据实际的IP来来定的。嗯，这只是一个事例。单方点先思考一下，然后请你要重处理。反正我们下午七八九张。第四张也会长。内容不算多啊。可以给大家看一下我们参考做法啊。参考做法的话。

其实我们模板这两前面几行固定不变的对吧？固定不变的可以写在上面。然后呢，后面我用循环，但这里要会用ho bus啊，用ho bus，因为要输输对应的主机主机的一个名称的啊，对应主机名称IP地址。

所以的话这里的话我我用ho bus来做。所以既然用ho bus呢就不能。就不能使用我们的。点啊全部使用框框，这样框起来。主要是输出我们的几个东西，一个是IP地址完成主机名以及减减掉的主机名。

然后用and for结尾。然后后面我们复这个模板。然后执行完之后呢，我们可以来看一下1个ETC。My host。所有主机我们运行完之后呢，应该是这样的一个结果。这样结果才正确的。因为时间关系。

我就先把这个练习先讲了。好吧，现在12点27分，我们下午2点钟2点05分啊，过5分钟我们讲第七章及之后的内容。好，中午啊先休息啊。下午见。

