# 2021全新 RHCE8.0 红帽认证入门教程——可零基础入门学习【网络安全／Linux】 - P60：Day10_Ch04c_管理事实 - IT老表哥 - BV1444y1h7Bx

好的，那我们现在来讲最后一节内容啊，所有的回来了啊。你们讲最后一节内容，管理事实能看到我屏幕跟声音，听到声音了啊。好，事实呢是什么意思？刚才我已经反复提到了，事实是asible执行在执行我们剧本的时候。

执行过程会去收集我们受管主机的一个通用信息啊，通用信息也就是一个变量，对吧？它返回的值也是变量，对不对？那返回变量，我们称之为。事实啊。就是既定的东西它不会发生改变了，对不对？我收集回来说，是不是他的。

状态都是。已经是定的了，对吧？我们简单说就是它的状态已经定的了。所以的话它这个的话就是一个事实了。然后描我们怎么去描述S4实呢？事实呢。呃，它有包含比如说我们的主机名称，主机名称、内核版本是吧？

网络接口。IP地址操作系统的版本，各种环境变量，我们都可以读取，对不对？然后还有就是我们CPU数量，提供可用的力内存磁盘空间，是不是有时候我们可以用它来干嘛呢？比如说我可以监测它的系种资源情况。

比如说我要更新一个内核，是不是我们可以查看内核版本来进行？我们可以帮根据我们的内存使用情况，是不是我们调整某些应用的一个内存的分配策略。或者是说我们来设置。IP地址是吧，可以新增配置。

我们的IP地址也是可以用的，对吧？他通常呃。通常在那个每个剧本在执行第一个任务之前，我们是不是有一个叫做get invest啊？它其实相当于我们运行一个叫set up模块的一个东西来收集事实。在以前2。

3。

![](img/078dcc1fb5d22247e91505ae12265e09_1.png)

以后的版本我们叫做gathering fast。对不对？看到没有？它它会自动运行啊，不不是说以前以前我们叫set up的这个任务啊，以前这个任务我们叫set up。

现在我们统称为gathering fat。所以他默认情况下呢，它会帮我们自动运行，不需要我们去手动去跑一遍，懂我意思吗？



![](img/078dcc1fb5d22247e91505ae12265e09_3.png)

那我如果要获取我们详细的一个事实信息，我们就要加一加一加一个话啊，加一句话叫ge the下划线fat等于。



![](img/078dcc1fb5d22247e91505ae12265e09_5.png)

Yes。懂吗？get the fatyes啊，不要加这句话。那好，我们现在通过一个剧本，我们来写一下一个事实信息。好，我们来看这边我们的演示啊。我们看这边也示。我倾一下屏。

pre bookley manfas电样帽。

![](img/078dcc1fb5d22247e91505ae12265e09_7.png)

好，来写一个剧本啊，日本我们例子在左边有。😀。有点咳嗽了啊，然后呢。那。display我们显示。获取事实的详细信息。作用主机，我们的受管主机。我假设我就获取跟斗德一就行了。Get的。F。yes，对不对？

我们加上这个选项，如果没有的话，它只它不会输出我们的那个是详细的事实信息，只会报告你OK对吧？那我们加上一句gether fat。yes的话，我们就可以获取到我们详细事实信息。然后呢。

我们来执行我们的任务。Tasks。Now。The bug。给 the fat。然后呢。用抵八方法。然后呢，用va。用va什么意思呢？它可以显示一个变量的，调用显示一个变量的信息。

我们所有啊在现在的那个机制下面。它的那个所有的事实，它会存到一个叫做answerable fat。这下划线fat这个变量里面懂我意思吗？它会将我们所有的。事实信息存到aner下划线fat这个变量。

那我们看一下保存退出。然后我们来运行一下这个剧本。我就不加杠B了哈。😊，来来来看一下。你看这长串的。就是他获取到一个。事实。懂吗？详细输出了，包括我们的ID地址。我们的buss日期是吧。

版本还有我们的分区，对吧？

![](img/078dcc1fb5d22247e91505ae12265e09_9.png)

![](img/078dcc1fb5d22247e91505ae12265e09_10.png)

嗯分区，然后我们的时间。IPP是地址，然后我们的磁盘对吧？以及光驱里面加载什么内容？然后呢，还有呢就是我们的设备。



![](img/078dcc1fb5d22247e91505ae12265e09_12.png)

很多啊。我们就不详细讲了，我们就知道他获取的东西非常多就这样。但是我们后面为什么要讲这个呢？因为有时候我们需要做的任务，就是我们要监控我们做观组机情况。那我们对这个事实做一些调用。就可以了，懂我意思吧？



![](img/078dcc1fb5d22247e91505ae12265e09_14.png)

那S40呢，比如说我们一些事例，我们看到啊看到左左我们看到左边的这个讲义里面S fat我么获取。比如说我们我们想获取我们的主机灵。对不对？获取主题名就是an so fast，后面ho that，对不对？

hos可以做到，然后获取我们完整的域名，我们叫完全现定域名，知道什么叫SQDN吧？for qualify domain完全合格的一个域名。就这里有一个叫FQ电下，然后我要获取一个主要IPV4地址。

就是default IPPV4，对吗？我要获取所有接口的列表。是不是有一个叫做。interface对不对？我我想获取具体的一个分区大小。对吧VDA一假设我个VDAE分区。对吧一大串就是一集一集下来的。

懂我吧？懂我意思吧？然后还有DS服务器列表，还有以及我们的内核版本都可以。然后我刚才说一个简写的，我这里已经有体现了啊。😊，可以简写啊。



![](img/078dcc1fb5d22247e91505ae12265e09_16.png)

就是在这里S我我们如果变量值为散列或者质点的话，我们可以用两种语法来检索值。对吧比如说IPP4 address我们可以就点点点下来，但是这里有个意外，你如果你的你的那个变量的值。

比如说我完全合格域名度不行了，因为中间本来带了点了，你除非用引号引起来，你可以试试。我到时我1点试一下啊。如果引号引不行的话，那我们就只能用括号懂我意思吧？



![](img/078dcc1fb5d22247e91505ae12265e09_18.png)

那我们来获取一个我们主机的FQDN，我们用剧本来实现。

![](img/078dcc1fb5d22247e91505ae12265e09_20.png)

我们这里也可以直接贵付IQFQDN，对不对？

![](img/078dcc1fb5d22247e91505ae12265e09_22.png)

![](img/078dcc1fb5d22247e91505ae12265e09_23.png)

这是可以获取到啊，这是一种减要方法。那如果用剧本实现呢？

![](img/078dcc1fb5d22247e91505ae12265e09_25.png)

![](img/078dcc1fb5d22247e91505ae12265e09_26.png)

我们这里可以后面加，我们用两种写法都可以用点SQDN或者是。用这种传统的是吧，都可以懂我意思吗？我下面加了井号的就是你两种写法都可以。而不是说你必要写。所以不要真是一如一红芦画瓢啊。



![](img/078dcc1fb5d22247e91505ae12265e09_28.png)

![](img/078dcc1fb5d22247e91505ae12265e09_29.png)

![](img/078dcc1fb5d22247e91505ae12265e09_30.png)

对吧我们是不是获取了node一的完全合格主机域名？

![](img/078dcc1fb5d22247e91505ae12265e09_32.png)

好吧。这里啊。

![](img/078dcc1fb5d22247e91505ae12265e09_34.png)

可以知道吗？明白吗？然后我可以获取他的短主居名就是ho snap。

![](img/078dcc1fb5d22247e91505ae12265e09_36.png)

![](img/078dcc1fb5d22247e91505ae12265e09_37.png)

![](img/078dcc1fb5d22247e91505ae12265e09_38.png)

![](img/078dcc1fb5d22247e91505ae12265e09_39.png)

短组机灵就是第一个点前面的一部分。

![](img/078dcc1fb5d22247e91505ae12265e09_41.png)

脑可获取获默认的IP地址IPV4地址。

![](img/078dcc1fb5d22247e91505ae12265e09_43.png)

![](img/078dcc1fb5d22247e91505ae12265e09_44.png)

我们获取deourIPV4里面 addresses。

![](img/078dcc1fb5d22247e91505ae12265e09_46.png)

反正一个个给他给他看啊。

![](img/078dcc1fb5d22247e91505ae12265e09_48.png)

对吧。

![](img/078dcc1fb5d22247e91505ae12265e09_50.png)

那我就获取网络接口。

![](img/078dcc1fb5d22247e91505ae12265e09_52.png)

![](img/078dcc1fb5d22247e91505ae12265e09_53.png)

看到没？

![](img/078dcc1fb5d22247e91505ae12265e09_55.png)

所以呢我们通常来说啊，他S以前呢现在是作为一个。变量的一部分对不？我们现在要引用要注入的话，我们像现在是用变量的一部分，懂吗？以前呢我们是作为单个变量，就是Sible下划线的是吧？到2。5版本之后呢。

就改成这样子了，它原来叫做S伯下划线ditribution，懂我意思吗？像我们C套模块以及我们运行赛套模块是不是会得到这样一个结果？我们刚才的第一次第一天在昨天我们在讲S博的时候。

是不是我们运行过这个命令？他预测的结果就是把这个列出来。作新旧事实的一个比较啊，我们通常现在用这种方法。就它作为SO fat一部分，然后呢我们直接去调用就可以了，懂我意思吧？如果你要用旧的也可以。

但是你可能新版本的话，你可能默认会把那个inject。faest as就是把这个调用的事实作为一个变量。这个值可能如果关闭的话，会关闭到我们旧命名的系统，懂我意思吧？所以开启跟关闭事实啊。

这里就用get fat的这个参数，明白我意思吧？OK的话，这个部分如果名没问题，请打字母Q有问题请提问。有有提前提问啊。所以现在应该知道事实是什么了。



![](img/078dcc1fb5d22247e91505ae12265e09_57.png)

好，接下来我们来讲一下创建自定事实。自定式这个啊我们在这里不做特别要求。但是我要我们要知道我们的自定事实可以在ETCS我目录下的fat点D这个目录里面创建啊可以加载。然后所有的那个脚本以及那个文件名称。

必须要以faest结尾，这个我们就一笔带过啊，一笔带过，我们就不再详细讲，我们接下来讲一个魔法变量魔法变量万能变量哈。有一些模块我们不需要通，我们可以不用set up啊ensible的ge进行输出。

但是它也可以用ensible来自动去设置。所以这些变量也可以获取到我们特定主机的相关信息。比如说我们的ho，就包含主机变量，可以用于获取另外一台授官主机的值，比如说我在note一。

我可以获取note2的信息，可以吗？还有group namess，我可以列出当前资产清单里面的所有组，对吧？把资产清单进行列出来。groups我可以列出所有资产清单。

然后invent host step我可以包含啊当前售款主机的所有名称。比如说我现在啊。

![](img/078dcc1fb5d22247e91505ae12265e09_59.png)

我把清单改一下。we servernote1DB servern2。好的。那我们写一个fat two点1。



![](img/078dcc1fb5d22247e91505ae12265e09_61.png)

哎，我写错文件名了啊，YML。好，然后呢。同样我们写个剧本name。Desp。嘅ther。F。information。后s之力我写新代表什么意思呢？任意主机也就这样相的哦。然后呢。

我这里还是我要调取事实吧，get faty，对不对？task。N。第bug。Get the fat。我们这里呢我们就不用an fat里面的任何条目了。我们用va，我们说把它这变量显示出来。

叫g names。这是我自己定义的哈，我们来看一下结果。

![](img/078dcc1fb5d22247e91505ae12265e09_63.png)

![](img/078dcc1fb5d22247e91505ae12265e09_64.png)

对吧来，我们来看一下ens play books。

![](img/078dcc1fb5d22247e91505ae12265e09_66.png)

![](img/078dcc1fb5d22247e91505ae12265e09_67.png)

![](img/078dcc1fb5d22247e91505ae12265e09_68.png)

![](img/078dcc1fb5d22247e91505ae12265e09_69.png)

看到没有？

![](img/078dcc1fb5d22247e91505ae12265e09_71.png)

看到没有？它这里的话是不是列出我们gomnet，就是我们node一跟note对应的主机组的名称。

![](img/078dcc1fb5d22247e91505ae12265e09_73.png)

这是S果里面定义的，而不是由S果 fat里面输出的。懂我的意思吗？这是第一个用法。

![](img/078dcc1fb5d22247e91505ae12265e09_75.png)

![](img/078dcc1fb5d22247e91505ae12265e09_76.png)

然后第二作用法，gth。还是这个列表。它是在售管主机上列出控制节点的。资产清单受款组列表。还是这个剧本。看到没有？是不是我们现在把资产现在列出来了？😊。



![](img/078dcc1fb5d22247e91505ae12265e09_78.png)

执行结果啊，因为我中间我个人都空完，所以他多了一个an groups。对不对？

![](img/078dcc1fb5d22247e91505ae12265e09_80.png)

然后第3个hose bus。我们这里回到serv斯那里。这里我的资本清单我是随便可以改的。我后面再加个service就行了。其实还是两台主机。note2点Lb点doule点com。



![](img/078dcc1fb5d22247e91505ae12265e09_82.png)

然后呢，我们来直接用ho bus来调用。然后这里的话我写的比较复杂，完全符合格主域名。我就是我只在。note2对吧？note2，然后呢。来显示note一的主机运维，懂我意思吧？我这个判断条件。

我这里加个5N啊。我这也有f3年么。🎼哎，我沸特了复制费翻算了。

![](img/078dcc1fb5d22247e91505ae12265e09_84.png)

![](img/078dcc1fb5d22247e91505ae12265e09_85.png)

好。

![](img/078dcc1fb5d22247e91505ae12265e09_87.png)

我们这里用。ラジラホホスバース啊。那我要引用某台主机的对吧？FQDN但这里的话我可以用这样子吗？我试一下啊。点answerable fast。点FQDN我试一下行不行？因为我之前我试过是不行的。

然后when我这里是判断条件。Answ for。5。点FQDN就读他这条件等于。node to点lab点com这个判断条件就是说我当我的完全合格主域名是n two的时候，是吧？

我输出node一和完全合格主机域名，我看一下有没有报错，因为这个我确实没试过啊。

![](img/078dcc1fb5d22247e91505ae12265e09_89.png)

Sciign text track。

![](img/078dcc1fb5d22247e91505ae12265e09_91.png)

没有问题，我们看一下有没有报错先。

![](img/078dcc1fb5d22247e91505ae12265e09_93.png)

![](img/078dcc1fb5d22247e91505ae12265e09_94.png)

![](img/078dcc1fb5d22247e91505ae12265e09_95.png)

不对啊，不能这么做的。对啊，因为它里面含有点呢，我们带引号也没什么用的。所以的话我们记得要改成我们讲义里面的这种形式。



![](img/078dcc1fb5d22247e91505ae12265e09_97.png)

因为它里面含了碘了。然后下面你这么写没问题。啊。

![](img/078dcc1fb5d22247e91505ae12265e09_99.png)

好嘞。在着纸平面。

![](img/078dcc1fb5d22247e91505ae12265e09_101.png)

![](img/078dcc1fb5d22247e91505ae12265e09_102.png)

哎，还是不对哦，unexpect，我是不是少了一个哦。🎼看一下all us，然后我的n一点exep账点com apple o fat orFQD我是写到外面去了。所以这语法有时候语法真的很要命啊。



![](img/078dcc1fb5d22247e91505ae12265e09_104.png)

![](img/078dcc1fb5d22247e91505ae12265e09_105.png)

看到没有？我note一因为不符合那个条件，不符合我们判断条件，已经被skiip掉了。

![](img/078dcc1fb5d22247e91505ae12265e09_107.png)

然后在node2上输出note一的，完全要这主机名。

![](img/078dcc1fb5d22247e91505ae12265e09_109.png)

懂我意思吧？

![](img/078dcc1fb5d22247e91505ae12265e09_111.png)

这就是我们的执行结果啦。如果传统解法就是这样啊，传统写法不加判断的话，直接输出每台机的主机域名。这传统解法。



![](img/078dcc1fb5d22247e91505ae12265e09_113.png)

![](img/078dcc1fb5d22247e91505ae12265e09_114.png)

懂我意思吗？就不对不在演演播点影是。然后一个inventoryho snap。

![](img/078dcc1fb5d22247e91505ae12265e09_116.png)

inventory hoststep这里的话它是可以调用资产清单里面的主机配置项。

![](img/078dcc1fb5d22247e91505ae12265e09_118.png)

🎼比如说我要复制一个像我这里f5。1么。

![](img/078dcc1fb5d22247e91505ae12265e09_120.png)

![](img/078dcc1fb5d22247e91505ae12265e09_121.png)

然后这里呢还是还是一样的。然后后面这里ho bus。我这里我要我要写一个东西啊，我就不不在屏幕显示出来了。我这里用copy。copy，然后呢。content对吧？我们可以直接一定要用变量输出我们的内容。

哎，我怎么变成选角了？好，host。vashova斯。n后note一。点la点doule点com。Now前面的ansable facts。然后里面的1个FQDN。然后这里我换换行啊。

我要换行okK然后我 destinationestation，我输出到1个TMP test我一个文件夹，然后when。inventory就清单里面的对吧？调用清单里面的主定义主机项。

我可以做这样一个判断，inventory whosese name等于。这这我提前讲的一个判断的啊，n two点lab点exle点com。



![](img/078dcc1fb5d22247e91505ae12265e09_123.png)

看一下有没有问题，先检查一下语法，我有点担心哈。

![](img/078dcc1fb5d22247e91505ae12265e09_125.png)

没问题，那我们运行一遍。同样我们会看到note一被ase掉。因为我们这样判断嘛。

![](img/078dcc1fb5d22247e91505ae12265e09_127.png)

![](img/078dcc1fb5d22247e91505ae12265e09_128.png)

note baseki掉，然后呢，我们看一下ensible，我们看一下note2的情况。

![](img/078dcc1fb5d22247e91505ae12265e09_130.png)

![](img/078dcc1fb5d22247e91505ae12265e09_131.png)

杠F self杠A。

![](img/078dcc1fb5d22247e91505ae12265e09_133.png)

cat里面的TMP test。

![](img/078dcc1fb5d22247e91505ae12265e09_135.png)

哎。是不是在note2里面。

![](img/078dcc1fb5d22247e91505ae12265e09_137.png)

![](img/078dcc1fb5d22247e91505ae12265e09_138.png)

node2里面输出了node一的域名啊。对吧。

![](img/078dcc1fb5d22247e91505ae12265e09_140.png)

是不是node2里面输出一些node一的完整域苗？

![](img/078dcc1fb5d22247e91505ae12265e09_142.png)

那OK了啊O这一块我们就比较。

![](img/078dcc1fb5d22247e91505ae12265e09_144.png)

你就比较清楚了。

![](img/078dcc1fb5d22247e91505ae12265e09_146.png)

那我们今天内容已经讲完了。今天我经讲完了，然后呢，如果明白的话，请打L。

![](img/078dcc1fb5d22247e91505ae12265e09_148.png)

![](img/078dcc1fb5d22247e91505ae12265e09_149.png)

大家这样的话这里没错啊，我刚才就是把这个写到外面去了，写了RAB那个字母，接下来顺下去的R。

![](img/078dcc1fb5d22247e91505ae12265e09_151.png)

![](img/078dcc1fb5d22247e91505ae12265e09_152.png)

![](img/078dcc1fb5d22247e91505ae12265e09_153.png)

![](img/078dcc1fb5d22247e91505ae12265e09_154.png)

![](img/078dcc1fb5d22247e91505ae12265e09_155.png)

![](img/078dcc1fb5d22247e91505ae12265e09_156.png)

![](img/078dcc1fb5d22247e91505ae12265e09_157.png)

有问题可以提问。我们今天的内容已经讲完了。

![](img/078dcc1fb5d22247e91505ae12265e09_159.png)

小啊，我看小杰这一块要不要做一下啊，小杰其实就是我们的一个变清单的一个定义位置，对吧？现在一个定义位置。然后还有呢就是我们的变量跟事实的一个管理啊。



![](img/078dcc1fb5d22247e91505ae12265e09_161.png)

![](img/078dcc1fb5d22247e91505ae12265e09_162.png)

![](img/078dcc1fb5d22247e91505ae12265e09_163.png)

![](img/078dcc1fb5d22247e91505ae12265e09_164.png)

本章知识点回顾贴过来给大家。

![](img/078dcc1fb5d22247e91505ae12265e09_166.png)

现场的人人明白啊。

![](img/078dcc1fb5d22247e91505ae12265e09_168.png)

拿想来。啊。谁。

![](img/078dcc1fb5d22247e91505ae12265e09_170.png)

能明白哈，本章字点回顾这么多，一个是定义变论路径是吧？

![](img/078dcc1fb5d22247e91505ae12265e09_172.png)

变量路径走定一边量位置啊。

![](img/078dcc1fb5d22247e91505ae12265e09_174.png)

还有一个就是android watch我知道，然后还有事时变量。魔法变量以及我们的注册变量啊，转存结果的注册变量。



![](img/078dcc1fb5d22247e91505ae12265e09_176.png)

考试肯定用到啊。我们事实的肯定会用到，就是说事实我们在在讲那一个。对比如说我们在实际应用上面，我讲一个实际应用啊，实际应用比如说我要生成一个宿管主机的一个清单报告。



![](img/078dcc1fb5d22247e91505ae12265e09_178.png)

![](img/078dcc1fb5d22247e91505ae12265e09_179.png)

我要列出它的内核版本磁盘容量、内存大小、CPU的类型。那是不是用到40了？对吧。可以理解吗？然后还有就是我要输出具体的一些信息，我要留在留留在里面用了啊，留在后续的剧本里面用。这个就是我们。

关于变量事实的一些用法，懂我意思吗？不会问我考试考不考，考试是肯定有有最一块坏的内容。然后呢，我们接下来啊下一周我们是停课的，这因为音乐主要是我有另外一个班要跟，而且是全程10天的。

所以的话这块我们下一下一次是安排到8月8号，8月8号你讲什么？接下来的一个任务控制，anible第五章任务控制以及。我吧。tempate的一个就我们那个tempate的一个模块。我们要讲。

然后最后一天还就还有一个管理大项目会涉及到就是一些并发现成数进程数的一个问题。这简单会过。然后呢，最后一天8月20应该是暂定是8月212号，等到时那个等班主任通知啊，就这一块的话，最后一天讲角色。

就这个整整合吧，讲角色，讲排错。然后就还有一个就是一个自别的例子。还有一个总复习，我们的12天课就结束了。所以还剩最后两天，这两天我们已经讲了50%的精髓了啊，还有一个任务控制。

这个是下周第三天的重点以及模板。然后接下来一个角色，其他没有了啊，所以我希望这接下来空出来的这一周多差不多十几天时间，把前面知识过一下，然后相关练习去巩固好吧，相关练习巩固。然后接下来看10分钟。

剩下我们最后10分钟时间，我们不讲新课内容，看看有没有。问题想提，有的话请提出来。今天就不再到。不再到不再到6点了啊，因为我们时间已补完了。没有问题，请倒湾有问题请提问。有问题吗？暂时没有吧去。啊。

自己照顾是吧啊。这些都是基础来的。没有问题，请打歪，有问题请提问，问题可以憋出来了。目前讲到我们的讲到的位置是第四章。因为前面这前面内容确实比较多比较杂，所以的话我们稍微进度稍微慢一点。啊。

接下来希望大家能够预习一下第五章内容。第五章和第六章，这是我们第三天啊，也就是8月8号。一个是关于。任务控制。加处理任务失败。这是第一部分讲内容。第二个就是一个模板。主要是金加兔，这是一个格式来的啊。

J two格式啊。模板就是我可以输出输出，然后获然后获得我相应的里面取直几面取值。剩下问题啊剩下有提问题可以提问。没问题的话，我们今天到这里啊今天就到这里，大概4点55分我们会下课啊。啊。

辛苦大这么久了。然后接下来有一周多的时间，希望大家能够好好的准备啊。最近考好像考试是好像9月份就有了。9月份吧。9月份应该会安排，最近的考试应该是7月30号，是上一批的。上一批的8。0的第二批。

9月份或者是暂定啊，这个还没确定时间。

![](img/078dcc1fb5d22247e91505ae12265e09_181.png)

到看大家的一个熟悉掌握的一个情况，好吧。

![](img/078dcc1fb5d22247e91505ae12265e09_183.png)

![](img/078dcc1fb5d22247e91505ae12265e09_184.png)

4点53分，如果没什么问题的话，我们今天到这里。那8月8号我们见啊，下课。

![](img/078dcc1fb5d22247e91505ae12265e09_186.png)