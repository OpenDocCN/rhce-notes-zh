# 【小白入门必备】Linux运维进阶RHCSA+RHCE最全培训教程视频合集 - P49：红帽RHCE-14.Shell四剑客之awk数据库过滤 - 洋洋得IE - BV1nN4y1X7Go

![](img/82edcafb6c9bd70842e9dc7baadc03b0_0.png)

开启录屏，喂喂喂，好，那接下来呢我们趁着这个声音这么清晰的时候，把这个AWK啊讲讲到这儿的时候，我们再来说一说哈，现在呢是要用begin，我们自己往里边输出点内容输出什么呢，用户名，用户名上。

然后这个唉那嗯啊用户名，然后他是嗯我们也来两个tab键也来，我们也来两个tab键哈，TT然后跟什么呢，跟这个解释器解释器OK回撤不是哈，中间正则表达式print啊，print print冰户名。

我们先先先这样哈好可以，然后再来，别跟，这中文得引起来用户名，然后TT因为你写中文他无法识别，然后他以为是指令呢，所以他报警，他说他说那叫CTX，他说语法错，然后解释器，啥情况放到一起。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_2.png)

看了吗，就是不是就这玩意儿是用户名解释器，然后但是我们如果想让它对齐的话，是不是这一跟七之间，是不是也是就别用逗号分隔了，这一个逗号在这儿表示一个空格，你不加的话，他就贴上了，看了吧。

所以咱们就听不见杠T杠T，杠T杠T听不见哎回车，呃啥情况呢，看看啊，一七他怎么又说我的语法错误呢，一没毛病，那就引起来吧，嘿嘿不对劲，这个，这玩意儿一，语法不错了，但是我们想要的呢没了是吧，一七。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_4.png)

那玩意啊TT是吧，TT需要引起来。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_6.png)

嘿嘿嘿嘿嘿嘿嘿，这样嗯这样不引的话，我看不引，如果嗯不仅不行啊，因为这个语法不是它的内置语法这个哈，所以它不识别，像我们前面这个也是放到引号了引起来了，不然AWK他不认识这东西是啥呀，是不是啊。

这不是我自带的语法呀，所以这样就可以了，这里面主要注意的就是很多东西啊，我们就是觉得没啥是吧，但是呢他就是不识别，所以计算机这东西就是一码是一码对比根，然后前置没前置命令。

是不是他在帮你去对这个文件做过滤之前，那咱们呢先帮你执行这类文命令，给你输出用户名跟解释器，然后接下来呢在执行什么呢，再执行后面的命令啊，过滤啊，我要过滤我的main开头的，然后print给我打印。

打印什么呀，哎给我打印他的第一列跟第七列，然后从这个文件里面打印，那end我们也可以来一个N，我在这再给大家说一下AWK的命令啊，它对于空格来讲要求不高，就是你的每一部分不加空格也没事。

你比如说我print不加空格，可不可以可以，你看我这里边每一部分是没有空格的，是不是没有空格，这命令太长了，一行已经放不下了就行，我们就这样回车诶，这不行啊，这得加空格啊，就是它的哪呢，print哎。

他print在打印的时候，你发现我是不是就直接在后边，就print跟它的内置变量的时候，这些是没有什么严格要求，但是最好为了美观啊，我们加空格，你看这位置就没有空格，是不是也没事，这怎么又错了呢。

哪哪一部分的问题呢，啊摁摁的，就这可以不用加空格，我记着没毛病，看到了吗，是不是这个位置你都不用加空格哈，没事他对空格要求不是很严谨，摁的再来一个打印，就每一部分都不用加空格。

print在打印什么呢啊我们再打印它的行号谁呀，唉NR啊行号，然后你前面自己加个输出EQ的中文什么，其实不用了不用了哈，不用加中文了，因为你加中文也没有意义了，这样就是把这个文件的第十呃。

这个总共有多少行给你输出出来了，总共有14行，就这玩意儿，就这玩意儿，这玩意儿只执行一次，文件处理完了好，我再给你输出一下这里的指令，这就是AWK的完整的命令，看了吗，前置命令执行一次。

中间命令逐行执行，安德里的命令也只执行一次，但是是最后执行，这里边还可以做一些什么加减乘除。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_8.png)

看到吗，print1010时间，五乘除取余都可以。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_10.png)

感兴趣可以自己练一练哈，这玩意还有if判断呢。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_12.png)

但是我们几乎用不到，在AWG里面我们用不到义务判断。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_14.png)

我们就用它做数据的处理，我们用不到，所以这个大家简单了解一下就行啊，你看他这里边什么if单分支，if双分支，还有循环呢，这里面支持数组。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_16.png)

支持循环，这个还有我跟你讲这样AWK里玩啊。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_18.png)

它是一门编程语言，任何编程语言里边是不是都支持什么判断数组。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_20.png)

循环加变量都可以哈哈那有了AWK啊。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_22.png)

当这些我们你不需要去什么呢，不需要去研究它，因为这样就这玩意儿是什么呢，就是，它的语法有点反人类嗯，对啥都支持就行了，反正我们用不到那么多，知道我我们会用它的循环判断吗，是不是用不到，所以简单了解一下。

然后下面看看，还可以结合这个前置命令管道，给它去过滤前置命令，比如说我想看内存，free杠H看内存，但是我想看我的内存的什么呢，剩余的这个还剩余内存，那这个时候你看的话，如果用group过滤怎么实现呢。

好用用GRAP过滤，那这个时候grape在过滤的时候，我们就过滤谁呀，能过滤free吗，过滤free当然是free杠H管道给GRP过滤，没有啊，敲错了是吧，敲错了，过滤出来了吗。

过滤了包含free的给你显示出来了，那这这是你想要的吗是吗，不是是不是不是我要的是下边的这个哎，这个数是不是，那咋过滤啊，过滤汤IMEM，哎没错，这是我想要的是吧，总内存剩余内存啊。

以使用内存还剩余内存，那这个时候我这样过滤不清晰，是不是不清晰呀，那怎么办呢，唉这个时候我就想看这个别的什么总内存，这些我不感兴趣，那grape是不是无法实现了呀，哎这时候别用grape了。

换成AWKAWKAWQ率匹配一下匹配，然后给我print打印第几列，1234，第四列没刀死回撤不对呀，不对呀，哎演起来，嗯不是啊，MEM看下a w k m e m print也没毛病啊，我这个。

是我拿的语法错了吗，我预判有毛病吗，这里边没没毛病啊，正则无法识别的啊，他可能是，正则表达式，无法识别证，如果不加引号还无法识别，你看这样的话，是不是就是完成了group无法适无无法完成的工作。

直接把这个剩余啊，就是你想看的这个剩余的给你过滤出来了，GRP不行，group这啥呀，是不是啥呀不行，那你在过滤的时候，我们是不是前面还可以自己来一些，比如说这个输出啊，你在打印的时候。

你就可以在里面加一些中文指定，看剩余内存，来个tab键，来个来个tab键回车，是不是可以能把这一列的过滤出来吗，可以可以哈，那你就别加正则了，不加正则了，回车是吧，这不就是直接就把这一列都过滤出来了。

就不匹配呗，这也可以，但如果我想匹配，就看剩余的，就先给我匹配了一行m em。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_24.png)

然后对不加F默认就是空格，这样可以看，但是是不是如果我们这样，如果你这样的话，它默认这就是它是T键，他这边是就是中间用tab键做的风格，看到了吧，那是不是，它默认就是可以识别这个tab键跟空格啊。

所以你就不用指了，不加杠F了，没有必要了，就哎就默认即可，所以这样就是我们只看什么呢，只看这一行的第四列剩余内存，是剩余内存2。0G，看起来清晰明了吧，是不是非常清晰明了，呵呵可以。

过滤网卡可不可以过滤我的网卡，if腾飞哥es32GB过滤怎么过滤的，老low了，grape啊，过滤谁呀，过滤这个入口的是吧，这是，If config e n s32，是不是啊，这我就想看谁。

就想看这个是不是就想看这个，那这时候GRP不行干嘛，A wk，Awk，先正则匹配一下，正则匹配，print答案第几列，12345，第五列，第五列，你说第五列看不懂啊，那干嘛呀，哎五逗号，65~6列。

嘿嘿这怎么不对呀，这怎么少了一个，后边这个是不是啊，你看它也识别啥了吗，它也识别这里边有个空格了对，所以这也是一列567列啊，然后那就不看第五列了是吧，就看第六列，第七列，第七列回车是吧，是不是可以。

然后前面输出一个输出什么呢，自己来一个，叫做啊，这个是入口流量，入口流量。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_26.png)

然后来个tab键回车。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_28.png)

回车，命令太长了是吧。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_30.png)

他说哎入口流量入口流量。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_32.png)

入口流量是不是去掉小括号，去掉小括号啊，去掉小号，去掉小括号的吧，好去掉小号，是不是我们想去掉小号，应该怎么办呢，把小号给它去掉，这时候想一想哈，怎么样才能把小号给它去掉呢，有方法吗，应该去不了。

好像去不了，因为它是贴着的，它是贴着的哈，那怎么办呢，在广东给AWK是吗，No no，我们这样cf指定分隔符是谁啊，是，中括号放里边，中括号可以匹配很多个分隔符，还以这个小括号做分割，或者这个做分隔。

我看看行不行，打印它的第几列呢。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_34.png)

看一看啊，他在第几列，如果是小括号的话，那这就是第一列小号，这是小号的话，这是第一列，这是第二列。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_36.png)

那打印的打印1~2里，试试啊还不行，这个，哪里错了呢，一动画二，是六七啊，这个小号不行，放到中括号里面，中括号可以帮你匹配的呀，这没毛病啊，这咋不识别呢。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_38.png)

无法识别呀。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_40.png)

这不行这不行啊，引起来是吧。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_42.png)

哎小号给他引起来。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_44.png)

啊入口流量那不是六跟七了。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_46.png)

那就是一。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_48.png)

可以是可以。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_50.png)

但是小括号是没了是吧。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_52.png)

入口流量前面的出来了，前面出来了哈啊。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_54.png)

那前面的，看哈可以可以是可以。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_56.png)

但是我们嗯以小括号为分割啊，前面的，但这些也输出出来了啊是吧。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_58.png)

小是，嗯哎呦这个有点啥了。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_60.png)

有点难度了，这个是不是有难度了哈。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_62.png)

有难度。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_64.png)

嘿有难度啊，这个然后那我们怎么样才能给他搞没呢。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_66.png)

好像这不行，这下期如果这个你们可以研究研究哈。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_68.png)

我下去我也研究研究，看这种功能可不可以实现，肯定是能实现的。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_70.png)

肯定是可以实现的哈，但是主要是这种，但是主要是这种这个。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_72.png)

五啊是六跟七哈六，可以实现哎，那这时候过滤出来之后，咱们干嘛呀，再对再来个管道行不行，对在管道在管道给谁呢，再管道给AWK，这时候，我再去嗯，或者说用用格栅外形GRA杠V取反，那不行，格瑞克不行啊。

在管道给AWK好，这时候我们在哎呦，这不行，这得好好研究研究，到时候你们可以下去好好研究研究，看看好，这里边我们过滤的话，就是可以过滤网卡的入口流量，出口流量看了吗，就像我像我刚刚那样写到脚本里面。

通过view循环，像刚刚那样，Vm，是可以的哈，其实是可以的，但是呢这个will点SH把这个拿过来，看看效果哈，看效果来执行他，入口流量出口流量IP是吧，IP怎么取出来的呀，唉也是打印它的第二列IP。

这条命令它显示出来以后，第二点就是它的IP地址，你看一下if configure，是不是过滤谁呀，过滤那这个INET，然后打印第二列就是它的IP，但是我们想想法，到时候把这个小括号给它去掉。

可以自己看一看怎么给它搞掉哈啊过滤跟分区，我问一下你们哈，这个能看懂吗，就是通过AWK后面这部分命令能看懂吗，看懂了给我刷刷一，看不懂的刷二，有有有看不懂的了吧。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_74.png)

看他没看懂嗯，这不就是我们刚刚在命令行里面，敲的那个命令吗，If config，看这个网卡管道给AWK是吧，AWK干嘛呀，正则啊，这就是放到斜线里面匹配了，给我匹配这个关键词。

匹配以后它的关键词是不是是这一行，但是我不要这个一个完整的这个行，干嘛呢，要第二列，然后就打印他的店里好自己EQ一个EQ，一个IP，那他就是这样IP，然后列就这个就是IP地址里面的第二列。

看懂sleep，看不懂clear。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_76.png)

你不clear，对这个位置有个六，你这个位置用空格区分，所以我过滤的时候，这个位置你发现这儿有个空格，不然他这个这两个都满足，知道吧。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_78.png)

对所以怎么样区分呢，用他们之间细节在这这是有个，你加个空格就行了，所以我们在过滤的时候，这位置也是多了一个空格，你不加空格是吧，那它也是包含的，所以用空格看懂sleep了。

sleep是为了让死循环循环的更慢一些，sleep clear干嘛呢，清屏啊，你不加clear，它的效果是什么效果呀，你想想哼，你不清平，搞得满屏都是看保存退出，看到了吗，就就这样，是不是就这样啊。

那如果你不清，如果说你清了屏呢，是不是每次他输出完以后，把这个屏幕给你清空一下呀，是不是在这，clear清个屏，诶你看每次给你清清一下，这样看起来有点清晰一些啊，就这样。

sleep是为了让死循环循环的更慢一些，别太快，太耗CPU，对这就是呃过滤我网卡的入口流量，出口流量啊也对，就是监视，但一般呢我们不用自己去写这个脚本，后期不都得学习那些监控软件吗，对监控软件嗯。

监控软件我们自己去什么呢，哎通过监控软件去监控，就是不会写，但是能看明白哎，能看明白就可以了。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_80.png)

也不需要你自己去写，是不是你现在你写不出来，现在这现在这水平，你想想你们能看懂都不错了，能看懂就能改编的脚本，我告诉你哈，这是我像我昨天所说的，大家现在就是能看懂就行，不需要你去自己有能力写对。

知道它能干嘛，知道它里边每一部分是干嘛用的，然后后期有需要你知道怎么改就可以了，然后这是怎么过滤跟分区，怎么过滤跟分区啊，DF杠H这是根分区的使用情况是吧，我想看谁，我想看我的牌可以使用的空间。

这不就是剩余吗，是不是啊啊，看可用空间，那管道给a w k pet key，然后默认是不是，他们之间就是空格作为分隔了呀，好那就不用管了，不用指定分隔符，然后接下来开始过滤过滤谁。

啊这个其实不用过滤了哈啊我看要不要过滤呢，嗯要不要过滤一下呢，没有过滤啊，就看嗯过啊，还是过滤一下吧，我看一下啊，过不过滤呢，过不过滤呢，在这里边还是过一下吧，我就看这一行。

不然他把上面的这个也给你显示出来了，那不行，所以AWK先在这把这个第二行取出来，就看第二行好，那怎么取第二行呢，在里面，就嗯指定在这里边哈，以根结尾的，完了这语法这能识别吗，看了吗。

这可能说他不知道我这语法里面是什么意思了，我们来看一眼啊，看这样行不行，然后再去print给我打印，打印第几列呢，1234，第四列，还识别不了怎么办啊，转个一，转移也不行，以根结尾的，看到了吗。

转移也不行，那就没辙了，不能这样玩了，就干嘛呢，搞rap，grape过滤以跟结尾的，在管道给AWK，这时候就不用正则匹配了，看到了吗，前面啊直接过滤，那这位置直接过滤以根结尾了是吧，你根结尾吗。

这一行不就不要了吗，好那这时候，或者说哎我们直接TAO也行，太杠一也可以也可以都行，这种方法是吧，就看最后一行管道给BWK管道给AWK，然后再打印，打印谁第几列呢，1234第四列是吧。

1234第四列没打死回车，显示最后一行过滤print第四列AWK，是哪里错了吗，没错，呃1234，Print awk，第四列，这怎么没生效呢，第四列，啊引号问题有可能他有的时候唉，你看双引就不行是吧。

引号问题不是杠N这个里面没有杠N哈，AAWK不是C的，C的，有杠杆，这里面没有杠杆，引号问题，你看这有的时候还必须得用单引，是不是，然后接下来呢那过滤出来之后25啊，还剩余是不是还剩余。

那后期的话如果你想判断的话，你可以写个义务判断啊，我的磁盘如果它的剩余空间小于多少的话，你给我做什么事情啊，这玩意儿如果写应该怎么写，怎么判断，是吧，这玩意儿是不是放在一个变量里面呢，唉放到变量里面。

变量叫什么都行，X等于曲面的结果，然后异物判断软件判断，好那这里的条件是什么呢，就是变量X如果小于是小于是LT小于多少，比如小于五的时候，给我，执行一个什么操作，是不是给我挨个一句话，EQ什么呀。

echo磁盘空间啊，叫做根根分区空间，还剩余还有剩余啊，或者说不足啊，空间不足是不是可以，当然我们这个有没有问题呢，这脚本有问题，为啥这个位置有个英文字幕，这个英文字母在这儿，它不能对。

通过这种方式去给你做什么呢，去做它的一个对比，因为它只能做数字对比，你加英文的话是不行的，所以这条命令是不是还有问题啊，它取出来有个G啊，他没有办法去给你做对比啊，有问题有问题哈，什么问题呢。

就是不能有那个G，等于5G等于等于5G嗯也行啊，那样可以，如果你要是说我不能做数字判断，那行哎，我们通过那种字符串去做一个什么呢，做一个对比，那里边可以用那种方法来实现内容，可以。

那就别用那种那个什么了，别用这种方法了，就唉等于等于这种是字符串做对比，等于5G的时候给我挨夸一句话，是不是，但是这脚本咋执行啊，这脚本咋执行啊，加循环，啊效率等于5G的时候，条件成立就执行命令啊。

咱不就一个是吧，条件成立就执行命令，那这脚本咋执行啊，加循环哎，来一个死循环，但是不能循环太快是吧，Sleep，一秒钟雄飞字唉，一秒钟循环一次，啊当然我们就给大家演示一下哈，对于这种事情。

你以为真需要你自己去写这玩意呢，不用后期有什么呢，有监控软件，监控软件会自动监控你的各个磁盘分区的，我们就给大家演示一下，这玩意儿就是他可以怎么写，怎么结合VIVO循环结合义务判断，结合AWK去判断。

那开机执行啊，如果有这种需要你开机执行的怎么办呢，唉放到一个就是有一个叫做开机，会帮你执行那个脚本的一个文件，etc叫RC点D，RCRC点D下面有个文件叫RC点local，这个文件里边。

RC点local这个文件里边就会帮你去看了吗，它里面是不是有一条命令叫touch这个文件去啊，你看它这里边就是告诉你了，这个文件是干嘛的呢，翻译一下哈，来，看一下上面的介绍，添加此文件为了什么兼容是吧。

不用管哈，强烈建议自己的cs m d服务什么规则了，就不用管，什么版本相比是吧，不用管，唉这个请注意，必须执行change mod加X命令，当地保证。



![](img/82edcafb6c9bd70842e9dc7baadc03b0_82.png)

该脚本将在什么期间执行，发现翻译了一堆，也没理解是干嘛的呢，就是你想让他帮你执行什么脚本，你呢注意哈，给那个脚本加个直营权限，加个执行权限以后，你把你要执行的那个命令，放到这个文件里面就行了。

就是把你的那个命令往这个文件里面写，怎么写呢，就写脚本用指定用batch给我执行这个叉叉点，差差点S1H这个脚本就行，他就帮你执行，但最好是指定这个解释器的绝对路径。

并且的batch给我执行叉叉哪个路径啊，啊就是是script下载叉叉点C执行本，一开机给你执行的脚本，一开机给你执行脚本，但是不要忘了提前给执行权限，他告诉你了，给谁执行权限呢，给这个文件执行权限。

注意是给这个文件加执行权限，然后开机他去执行这个文件，这文件里的命令他就帮你执行了，先给这先给这个文件执行权限，然后呢再给你的脚本给执行权限，一开机他帮你执行这个文件，那这个文件里面是什么命令。

它就帮你去按照命令给你去执行，帮你执行这些本能理解吧，是这意思好嗯，然后他说啊，那样G就没了是吧，怎么没呢啊，对你可以指定分隔符，这样杠F以G作为分隔的话，那就只取数哲学书，不要那个英文字母啊。

AWK好了，就讲这么多吧，今天啊今天就讲这么多，然后下边的内容，下面的计划任务，计划任务，防火墙。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_84.png)

行就这么多，差不多了。

![](img/82edcafb6c9bd70842e9dc7baadc03b0_86.png)